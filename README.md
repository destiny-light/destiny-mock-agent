# destiny-mock-agent
零侵入拦截指定的方法，为其生成Mock数据。

# 概述
在项目开发过程中，我们经常会遇到当前所开发的应用(或者微服务、模块等)所依赖的其他第三方应用未开发完成、无法部署测试环境等情况。此时，我们对这些第三方应用的服务调用，需要采用构造Mock数据的方式来模拟。构造Mock的方式可能包括：
- 提供专门的挡板系统，模拟第三方应用的服务调用。这种方式需要采购或者开发专门的挡板系统。而且，使用挡板系统，通常会拦截该第三方应用的所有服务调用，不能支持部分服务接口使用挡板系统、部分服务接口直接调用第三方应用的场景。
- 采用mockito等框架，编写mock测试案例。这种方式需要学习相应的mock框架，并需要开发相应的mock代码。不过，这种方式也是网上比较主流的。
- 修改业务代码。将调用第三方应用的服务的代码，修改成生成相应的响应数据的代码。这种方式，很容易理解，因此在很多项目中都被采用。但这种方式将粗暴地修改业务源代码，如果在提测或者上线时，忘记恢复这些代码，这很可能会造成非常严重的生产事故。如果开发过程中，开发人员离职或者调换工作，这种风险出现的概率将会非常高。

Mock拦截器组件(天命Mock代理)，通过Java Agent的方式，在开发、测试环境，编写相关的Mock数据配置文件。相对于其他Mock方式，Mock拦截器组件具有以下优势：
- 安全：Mock拦截器组件采用Java Agent的方式使用，即需要在启动应用的"java"命令或者脚本中，手工添加"-javaagent:..."选项来激活。而在应用部署到生产环境时，只需要确保没有"-javaagent:..."选项或者没有"mock"目录即可。
- 代码零侵入：使用Mock拦截器组件，不需要修改主应用的任何代码，包括pom.xml、application.yml、java、Mappger.xml等。
- 易于安装：不需要修改主应用的任何源代码，只需要在启动应用的"java"命令或者脚本中，手工添加"-javaagent:..."选项即可。
- 易于使用：Mock拦截器组件的数据配置文件采用JSON格式的文件，使用最简单的规则就可以满足绝大多数的mock需求。对于某些比较复杂的mock需求（例如：使用通配符定义的拦截目标、根据入参的值确定不同的mock数据，等等），编写相应规则的学习难度也非常低。
- 既可以用于开发人员的本机开发环境，也可以用于SIT、UAT等测试环境。
